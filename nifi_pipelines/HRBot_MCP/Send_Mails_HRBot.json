{"flowContents":{"identifier":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9","instanceIdentifier":"641d177a-0198-1000-ffff-ffffff629c21","name":"Send Mails","comments":"","position":{"x":-2096.0,"y":-656.0},"processGroups":[],"remoteProcessGroups":[],"processors":[{"identifier":"fd85cc69-3914-3b14-84df-99bca3db0892","instanceIdentifier":"64edb858-0198-1000-ffff-ffffc277ae5c","name":"TailFile","comments":"","position":{"x":-1656.0,"y":-776.0},"type":"org.apache.nifi.processors.standard.TailFile","bundle":{"group":"org.apache.nifi","artifact":"nifi-standard-nar","version":"2.4.0"},"properties":{"tailfile-recursive-lookup":"false","File Location":"Remote","Line Start Pattern":null,"Rolling Filename Pattern":null,"Initial Start Position":"Beginning of Time","pre-allocated-buffer-size":"65536 B","Post-Rollover Tail Period":"0 sec","tail-base-directory":null,"reread-on-nul":"false","tailfile-maximum-age":"24 hours","Max Buffer Size":"64 KB","File to Tail":"/home/nifi/nifi2/users/HR_Teams_Bot_Dev/llm_usage.log","tailfile-lookup-frequency":"10 minutes","tail-mode":"Single file"},"propertyDescriptors":{"tailfile-recursive-lookup":{"name":"tailfile-recursive-lookup","displayName":"Recursive lookup","identifiesControllerService":false,"sensitive":false,"dynamic":false},"File Location":{"name":"File Location","displayName":"State Location","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Line Start Pattern":{"name":"Line Start Pattern","displayName":"Line Start Pattern","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Rolling Filename Pattern":{"name":"Rolling Filename Pattern","displayName":"Rolling Filename Pattern","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Initial Start Position":{"name":"Initial Start Position","displayName":"Initial Start Position","identifiesControllerService":false,"sensitive":false,"dynamic":false},"pre-allocated-buffer-size":{"name":"pre-allocated-buffer-size","displayName":"Pre-Allocated Buffer Size","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Post-Rollover Tail Period":{"name":"Post-Rollover Tail Period","displayName":"Post-Rollover Tail Period","identifiesControllerService":false,"sensitive":false,"dynamic":false},"tail-base-directory":{"name":"tail-base-directory","displayName":"Base directory","identifiesControllerService":false,"sensitive":false,"dynamic":false},"reread-on-nul":{"name":"reread-on-nul","displayName":"Reread when NUL encountered","identifiesControllerService":false,"sensitive":false,"dynamic":false},"tailfile-maximum-age":{"name":"tailfile-maximum-age","displayName":"Maximum age","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Max Buffer Size":{"name":"Max Buffer Size","displayName":"Max Buffer Size","identifiesControllerService":false,"sensitive":false,"dynamic":false},"File to Tail":{"name":"File to Tail","displayName":"File(s) to Tail","identifiesControllerService":false,"sensitive":false,"dynamic":false},"tailfile-lookup-frequency":{"name":"tailfile-lookup-frequency","displayName":"Lookup frequency","identifiesControllerService":false,"sensitive":false,"dynamic":false},"tail-mode":{"name":"tail-mode","displayName":"Tailing mode","identifiesControllerService":false,"sensitive":false,"dynamic":false}},"style":{},"schedulingPeriod":"0 0 11 ? * MON","schedulingStrategy":"CRON_DRIVEN","executionNode":"ALL","penaltyDuration":"30 sec","yieldDuration":"1 sec","bulletinLevel":"WARN","runDurationMillis":0,"concurrentlySchedulableTaskCount":1,"autoTerminatedRelationships":[],"scheduledState":"ENABLED","retryCount":10,"retriedRelationships":[],"backoffMechanism":"PENALIZE_FLOWFILE","maxBackoffPeriod":"10 mins","componentType":"PROCESSOR","groupIdentifier":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9"},{"identifier":"d9ed720a-8c1c-3678-0000-00000c520789","instanceIdentifier":"1541cfea-eb10-3388-9e6f-82947628c20e","name":"InvokeHTTP","comments":"","position":{"x":-1112.0,"y":-360.0},"type":"org.apache.nifi.processors.standard.InvokeHTTP","bundle":{"group":"org.apache.nifi","artifact":"nifi-standard-nar","version":"2.4.0"},"properties":{"Request Content-Encoding":"DISABLED","proxy-configuration-service":null,"Request Multipart Form-Data Filename Enabled":"true","Request Chunked Transfer-Encoding Enabled":"false","Response Header Request Attributes Prefix":null,"HTTP/2 Disabled":"False","Connection Timeout":"5 secs","Response Cookie Strategy":"DISABLED","Socket Read Timeout":"15 secs","Socket Idle Connections":"5","Request Body Enabled":"true","OAuth2 Access Token Refresh Strategy":"ON_TOKEN_EXPIRATION","HTTP URL":"https://graph.microsoft.com/v1.0/me/sendMail","Request OAuth2 Access Token Provider":"eac367df-5f55-3e64-8cfe-21c3bb80a6bb","Socket Idle Timeout":"5 mins","Response Redirects Enabled":"True","Socket Write Timeout":"15 secs","Request Header Attributes Pattern":null,"Response FlowFile Naming Strategy":"RANDOM","Response Cache Enabled":"false","Request Date Header Enabled":"True","Request Failure Penalization Enabled":"false","Response Body Attribute Size":"256","SSL Context Service":null,"Response Generation Required":"false","Request User-Agent":null,"Response Header Request Attributes Enabled":"false","HTTP Method":"POST","Request Username":null,"Request Content-Type":"application/json","Response Body Attribute Name":null,"Request Digest Authentication Enabled":"false","Request Multipart Form-Data Name":null,"Response Cache Size":"10MB","Response Body Ignored":"false"},"propertyDescriptors":{"Request Content-Encoding":{"name":"Request Content-Encoding","displayName":"Request Content-Encoding","identifiesControllerService":false,"sensitive":false,"dynamic":false},"proxy-configuration-service":{"name":"proxy-configuration-service","displayName":"Proxy Configuration Service","identifiesControllerService":true,"sensitive":false,"dynamic":false},"Request Multipart Form-Data Filename Enabled":{"name":"Request Multipart Form-Data Filename Enabled","displayName":"Request Multipart Form-Data Filename Enabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Chunked Transfer-Encoding Enabled":{"name":"Request Chunked Transfer-Encoding Enabled","displayName":"Request Chunked Transfer-Encoding Enabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response Header Request Attributes Prefix":{"name":"Response Header Request Attributes Prefix","displayName":"Response Header Request Attributes Prefix","identifiesControllerService":false,"sensitive":false,"dynamic":false},"HTTP/2 Disabled":{"name":"HTTP/2 Disabled","displayName":"HTTP/2 Disabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Connection Timeout":{"name":"Connection Timeout","displayName":"Connection Timeout","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response Cookie Strategy":{"name":"Response Cookie Strategy","displayName":"Response Cookie Strategy","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Password":{"name":"Request Password","displayName":"Request Password","identifiesControllerService":false,"sensitive":true,"dynamic":false},"Socket Read Timeout":{"name":"Socket Read Timeout","displayName":"Socket Read Timeout","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Socket Idle Connections":{"name":"Socket Idle Connections","displayName":"Socket Idle Connections","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Body Enabled":{"name":"Request Body Enabled","displayName":"Request Body Enabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"OAuth2 Access Token Refresh Strategy":{"name":"OAuth2 Access Token Refresh Strategy","displayName":"OAuth2 Access Token Refresh Strategy","identifiesControllerService":false,"sensitive":false,"dynamic":false},"HTTP URL":{"name":"HTTP URL","displayName":"HTTP URL","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request OAuth2 Access Token Provider":{"name":"Request OAuth2 Access Token Provider","displayName":"Request OAuth2 Access Token Provider","identifiesControllerService":true,"sensitive":false,"dynamic":false},"Socket Idle Timeout":{"name":"Socket Idle Timeout","displayName":"Socket Idle Timeout","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response Redirects Enabled":{"name":"Response Redirects Enabled","displayName":"Response Redirects Enabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Socket Write Timeout":{"name":"Socket Write Timeout","displayName":"Socket Write Timeout","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Header Attributes Pattern":{"name":"Request Header Attributes Pattern","displayName":"Request Header Attributes Pattern","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response FlowFile Naming Strategy":{"name":"Response FlowFile Naming Strategy","displayName":"Response FlowFile Naming Strategy","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response Cache Enabled":{"name":"Response Cache Enabled","displayName":"Response Cache Enabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Date Header Enabled":{"name":"Request Date Header Enabled","displayName":"Request Date Header Enabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Failure Penalization Enabled":{"name":"Request Failure Penalization Enabled","displayName":"Request Failure Penalization Enabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response Body Attribute Size":{"name":"Response Body Attribute Size","displayName":"Response Body Attribute Size","identifiesControllerService":false,"sensitive":false,"dynamic":false},"SSL Context Service":{"name":"SSL Context Service","displayName":"SSL Context Service","identifiesControllerService":true,"sensitive":false,"dynamic":false},"Response Generation Required":{"name":"Response Generation Required","displayName":"Response Generation Required","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request User-Agent":{"name":"Request User-Agent","displayName":"Request User-Agent","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response Header Request Attributes Enabled":{"name":"Response Header Request Attributes Enabled","displayName":"Response Header Request Attributes Enabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"HTTP Method":{"name":"HTTP Method","displayName":"HTTP Method","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Username":{"name":"Request Username","displayName":"Request Username","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Content-Type":{"name":"Request Content-Type","displayName":"Request Content-Type","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response Body Attribute Name":{"name":"Response Body Attribute Name","displayName":"Response Body Attribute Name","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Digest Authentication Enabled":{"name":"Request Digest Authentication Enabled","displayName":"Request Digest Authentication Enabled","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Request Multipart Form-Data Name":{"name":"Request Multipart Form-Data Name","displayName":"Request Multipart Form-Data Name","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response Cache Size":{"name":"Response Cache Size","displayName":"Response Cache Size","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Response Body Ignored":{"name":"Response Body Ignored","displayName":"Response Body Ignored","identifiesControllerService":false,"sensitive":false,"dynamic":false}},"style":{},"schedulingPeriod":"0 sec","schedulingStrategy":"TIMER_DRIVEN","executionNode":"ALL","penaltyDuration":"30 sec","yieldDuration":"1 sec","bulletinLevel":"WARN","runDurationMillis":0,"concurrentlySchedulableTaskCount":1,"autoTerminatedRelationships":["Response","No Retry","Retry","Original","Failure"],"scheduledState":"ENABLED","retryCount":10,"retriedRelationships":[],"backoffMechanism":"PENALIZE_FLOWFILE","maxBackoffPeriod":"10 mins","componentType":"PROCESSOR","groupIdentifier":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9"},{"identifier":"3dcc957b-8e1c-3ec3-8497-e4024b33fff8","instanceIdentifier":"64eb52af-0198-1000-ffff-ffffaef52a5b","name":"ExecuteGroovyScript","comments":"","position":{"x":-1320.0,"y":-584.0},"type":"org.apache.nifi.processors.groovyx.ExecuteGroovyScript","bundle":{"group":"org.apache.nifi","artifact":"nifi-groovyx-nar","version":"2.4.0"},"properties":{"groovyx-script-body":"import java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonBuilder\nimport java.util.Calendar // Import the Calendar utility for robust date handling\n\ndef flowFile = session.get()\nif (!flowFile) {\n    return\n}\n\n// --- Configuration ---\ndef usdToInrRate = 87.23\n\n// --- Initialization ---\ndef totalCostUsd = 0.0\ndef endpointCounts = [:]\n\n// --- Log Processing ---\n// This section reads the log file and aggregates the data.\nflowFile.read { inputStream ->\n    inputStream.eachLine { line ->\n        // Parse LLM cost lines\n        if (line.startsWith(\"LLM_USAGE\")) {\n            def match = line =~ /total_cost=\\$([0-9.]+)/\n            if (match) {\n                totalCostUsd += match[0][1].toDouble()\n            }\n        // Parse validated endpoint JSON lines\n        } else if (line.startsWith(\"{\")) {\n            try {\n                def json = new JsonSlurper().parseText(line)\n                if (json.containsKey('endpoint') && json.containsKey('ip') && json.endpoint instanceof String && json.endpoint.startsWith(\"/\")) {\n                    def endpoint = json.endpoint\n                    if (endpoint) {\n                        endpointCounts[endpoint] = (endpointCounts[endpoint] ?: 0) + 1\n                    }\n                }\n            } catch (e) {\n                // Safely ignore invalid lines\n            }\n        }\n    }\n}\n\n// --- Report Generation ---\n\n// 1. **Robust Date Calculation for Previous Monday-Friday Week**\n// This logic correctly calculates the period regardless of what day the script runs.\ndef calendar = Calendar.getInstance()\n// Start searching from yesterday to ensure we're always in the past\ncalendar.add(Calendar.DATE, -1)\n\n// Loop backwards until we find the most recent Friday\nwhile (calendar.get(Calendar.DAY_OF_WEEK) != Calendar.FRIDAY) {\n    calendar.add(Calendar.DATE, -1)\n}\ndef weekEnd = calendar.getTime() // This is the end of our report period (last Friday)\n\n// Subtract 4 days from Friday to get the corresponding Monday\ncalendar.add(Calendar.DATE, -4)\ndef weekStart = calendar.getTime() // This is the start of our report period\n\ndef formattedWeekStart = weekStart.format('dd MMM')\ndef formattedWeekEnd = weekEnd.format('dd MMM yyyy')\ndef reportPeriod = \"${formattedWeekStart} - ${formattedWeekEnd}\"\n\n\n// 2. Calculate cost in INR\ndef totalCostInr = totalCostUsd * usdToInrRate\n\n// 3. Build the final HTML email body\ndef reportBody = new StringBuilder()\nreportBody.append(\"<html><body style='font-family: Arial, sans-serif; color: #333;'>\")\nreportBody.append(\"<h2>Greetings, Team!</h2>\")\nreportBody.append(\"<p>Here is the automated weekly usage and cost report for the period of <b>${reportPeriod}</b>.</p>\")\n\n// Cost Summary Table\nreportBody.append(\"<h3>Cost Summary</h3>\")\nreportBody.append(\"<table border='1' cellpadding='10' cellspacing='0' style='border-collapse: collapse; width: 400px;'>\")\nreportBody.append(\"<tr style='background-color: #f2f2f2;'><th>Currency</th><th>Total Cost</th></tr>\")\nreportBody.append(\"<tr><td style='padding-left: 10px;'>USD (\\$)</td><td style='padding-left: 10px;'>${String.format('%.6f', totalCostUsd)}</td></tr>\")\nreportBody.append(\"<tr><td style='padding-left: 10px;'>INR (â‚¹)</td><td style='padding-left: 10px;'>${String.format('%.2f', totalCostInr)}</td></tr>\")\nreportBody.append(\"</table>\")\n\n// Command Usage Table\nreportBody.append(\"<h3>Command Usage</h3>\")\nif (endpointCounts.isEmpty()) {\n    reportBody.append(\"<p>No valid command usage was recorded during this period.</p>\")\n} else {\n    reportBody.append(\"<table border='1' cellpadding='10' cellspacing='0' style='border-collapse: collapse; width: 400px;'>\")\n    reportBody.append(\"<tr style='background-color: #f2f2f2;'><th>Command</th><th>Request Count</th></tr>\")\n    endpointCounts.sort().each { command, count ->\n        reportBody.append(\"<tr><td style='padding-left: 10px;'>${command}</td><td style='padding-left: 10px;'>${count} times</td></tr>\")\n    }\n    reportBody.append(\"</table>\")\n}\n\n// Closing\nreportBody.append(\"<p>This is an automated report. Please contact the support team if you have any questions.</p>\")\nreportBody.append(\"<p>Support contact details:- <a href='mailto:kushagra.wadhwa@shorthills.ai'>kushagra.wadhwa@shorthills.ai</a></p>\")\nreportBody.append(\"<p>Regards,<br><b>HR Bot</b></p>\")\nreportBody.append(\"</body></html>\")\n\n\n// 4. Build the final JSON payload for the email API\ndef finalJson = new JsonBuilder()\ndef reportSubject = \"Weekly Usage Report: ${reportPeriod}\"\n\nfinalJson {\n    message {\n        subject reportSubject\n        body {\n            contentType \"HTML\"\n            content reportBody.toString()\n        }\n        toRecipients([\n            [emailAddress: [address: \"kushagra.wadhwa@shorthills.ai\"]]\n        ])\n    }\n    saveToSentItems \"true\"\n}\n\n// --- Final Steps in NiFi ---\nflowFile = session.write(flowFile, { outputStream ->\n    outputStream.write(finalJson.toPrettyString().getBytes(StandardCharsets.UTF_8))\n})\nsession.transfer(flowFile, REL_SUCCESS)","groovyx-failure-strategy":"rollback","groovyx-additional-classpath":null,"groovyx-script-file":null},"propertyDescriptors":{"groovyx-script-body":{"name":"groovyx-script-body","displayName":"Script Body","identifiesControllerService":false,"sensitive":false,"dynamic":false},"groovyx-failure-strategy":{"name":"groovyx-failure-strategy","displayName":"Failure strategy","identifiesControllerService":false,"sensitive":false,"dynamic":false},"groovyx-additional-classpath":{"name":"groovyx-additional-classpath","displayName":"Additional classpath","identifiesControllerService":false,"sensitive":false,"dynamic":false},"groovyx-script-file":{"name":"groovyx-script-file","displayName":"Script File","identifiesControllerService":false,"sensitive":false,"dynamic":false,"resourceDefinition":{"cardinality":"SINGLE","resourceTypes":["FILE"]}}},"style":{},"schedulingPeriod":"0 sec","schedulingStrategy":"TIMER_DRIVEN","executionNode":"ALL","penaltyDuration":"30 sec","yieldDuration":"1 sec","bulletinLevel":"WARN","runDurationMillis":0,"concurrentlySchedulableTaskCount":1,"autoTerminatedRelationships":["failure"],"scheduledState":"ENABLED","retryCount":10,"retriedRelationships":[],"backoffMechanism":"PENALIZE_FLOWFILE","maxBackoffPeriod":"10 mins","componentType":"PROCESSOR","groupIdentifier":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9"}],"inputPorts":[],"outputPorts":[],"connections":[{"identifier":"b491afc2-8c00-3528-9215-72b52b94c898","instanceIdentifier":"6ff95f07-0198-1000-ffff-ffffc2aa4d0b","name":"","source":{"id":"3dcc957b-8e1c-3ec3-8497-e4024b33fff8","type":"PROCESSOR","groupId":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9","name":"ExecuteGroovyScript","comments":"","instanceIdentifier":"64eb52af-0198-1000-ffff-ffffaef52a5b"},"destination":{"id":"d9ed720a-8c1c-3678-0000-00000c520789","type":"PROCESSOR","groupId":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9","name":"InvokeHTTP","comments":"","instanceIdentifier":"1541cfea-eb10-3388-9e6f-82947628c20e"},"labelIndex":0,"zIndex":14,"selectedRelationships":["success"],"backPressureObjectThreshold":10000,"backPressureDataSizeThreshold":"1 GB","flowFileExpiration":"0 sec","prioritizers":[],"bends":[],"loadBalanceStrategy":"DO_NOT_LOAD_BALANCE","partitioningAttribute":"","loadBalanceCompression":"DO_NOT_COMPRESS","componentType":"CONNECTION","groupIdentifier":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9"},{"identifier":"efa68ab4-53be-3d6b-8da7-98984061352e","instanceIdentifier":"64edce17-0198-1000-ffff-ffffadd7d85c","name":"","source":{"id":"fd85cc69-3914-3b14-84df-99bca3db0892","type":"PROCESSOR","groupId":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9","name":"TailFile","comments":"","instanceIdentifier":"64edb858-0198-1000-ffff-ffffc277ae5c"},"destination":{"id":"3dcc957b-8e1c-3ec3-8497-e4024b33fff8","type":"PROCESSOR","groupId":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9","name":"ExecuteGroovyScript","comments":"","instanceIdentifier":"64eb52af-0198-1000-ffff-ffffaef52a5b"},"labelIndex":0,"zIndex":13,"selectedRelationships":["success"],"backPressureObjectThreshold":10000,"backPressureDataSizeThreshold":"1 GB","flowFileExpiration":"0 sec","prioritizers":[],"bends":[],"loadBalanceStrategy":"DO_NOT_LOAD_BALANCE","partitioningAttribute":"","loadBalanceCompression":"DO_NOT_COMPRESS","componentType":"CONNECTION","groupIdentifier":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9"}],"labels":[],"funnels":[],"controllerServices":[{"identifier":"eac367df-5f55-3e64-8cfe-21c3bb80a6bb","instanceIdentifier":"650c565e-0198-1000-0000-00007baa18aa","name":"StandardOauth2AccessTokenProvider","comments":"","type":"org.apache.nifi.oauth2.StandardOauth2AccessTokenProvider","bundle":{"group":"org.apache.nifi","artifact":"nifi-oauth2-provider-nar","version":"2.4.0"},"properties":{"Refresh Window":"0 s","SSL Context Service":null,"Authorization Server URL":"https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token","Client ID":"<client_id>","Scope":"https://graph.microsoft.com/.default","Username":null,"Audience":null,"proxy-configuration-service":null,"Resource":null,"Grant Type":"client_credentials","HTTP Protocols":"H2_HTTP_1_1","Client Authentication Strategy":"REQUEST_BODY"},"propertyDescriptors":{"Client ID":{"name":"Client ID","displayName":"Client ID","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Audience":{"name":"Audience","displayName":"Audience","identifiesControllerService":false,"sensitive":false,"dynamic":false},"proxy-configuration-service":{"name":"proxy-configuration-service","displayName":"Proxy Configuration Service","identifiesControllerService":true,"sensitive":false,"dynamic":false},"Resource":{"name":"Resource","displayName":"Resource","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Grant Type":{"name":"Grant Type","displayName":"Grant Type","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Refresh Token":{"name":"Refresh Token","displayName":"Refresh Token","identifiesControllerService":false,"sensitive":true,"dynamic":false},"HTTP Protocols":{"name":"HTTP Protocols","displayName":"HTTP Protocols","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Refresh Window":{"name":"Refresh Window","displayName":"Refresh Window","identifiesControllerService":false,"sensitive":false,"dynamic":false},"SSL Context Service":{"name":"SSL Context Service","displayName":"SSL Context Service","identifiesControllerService":true,"sensitive":false,"dynamic":false},"Authorization Server URL":{"name":"Authorization Server URL","displayName":"Authorization Server URL","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Client secret":{"name":"Client secret","displayName":"Client secret","identifiesControllerService":false,"sensitive":true,"dynamic":false},"Scope":{"name":"Scope","displayName":"Scope","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Username":{"name":"Username","displayName":"Username","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Client Authentication Strategy":{"name":"Client Authentication Strategy","displayName":"Client Authentication Strategy","identifiesControllerService":false,"sensitive":false,"dynamic":false},"Password":{"name":"Password","displayName":"Password","identifiesControllerService":false,"sensitive":true,"dynamic":false}},"controllerServiceApis":[{"type":"org.apache.nifi.oauth2.OAuth2AccessTokenProvider","bundle":{"group":"org.apache.nifi","artifact":"nifi-standard-services-api-nar","version":"2.4.0"}}],"scheduledState":"DISABLED","bulletinLevel":"WARN","componentType":"CONTROLLER_SERVICE","groupIdentifier":"8aa1c3b1-dfcf-3aed-ac0e-ed1e25e356b9"}],"parameterContextName":"Azure_OpenAI_Config","defaultFlowFileExpiration":"0 sec","defaultBackPressureObjectThreshold":10000,"defaultBackPressureDataSizeThreshold":"1 GB","scheduledState":"ENABLED","executionEngine":"INHERITED","maxConcurrentTasks":1,"statelessFlowTimeout":"1 min","flowFileConcurrency":"UNBOUNDED","flowFileOutboundPolicy":"STREAM_WHEN_AVAILABLE","componentType":"PROCESS_GROUP"},"externalControllerServices":{},"parameterContexts":{"Azure_OpenAI_Config":{"name":"Azure_OpenAI_Config","parameters":[{"name":"AZURE_API_KEY","description":"","sensitive":false,"provided":false,"value":"<api_key>"},{"name":"employee_id","description":"","sensitive":false,"provided":false,"value":"${employee_id}"},{"name":"llm_prompt_tokens","description":"","sensitive":false,"provided":false,"value":"${llm_prompt_tokens}"},{"name":"llm_model","description":"","sensitive":false,"provided":false,"value":"${llm_model}"},{"name":"llm_total_tokens","description":"","sensitive":false,"provided":false,"value":"${llm_total_tokens}"},{"name":"AZURE_API_VERSION","description":"","sensitive":false,"provided":false,"value":"2024-08-01-preview"},{"name":"llm_completion_tokens","description":"","sensitive":false,"provided":false,"value":"${llm_completion_tokens}"},{"name":"AZURE_DEPLOYMENT","description":"","sensitive":false,"provided":false,"value":"gpt-4o-mini"},{"name":"AZURE_ENDPOINT","description":"","sensitive":false,"provided":false,"value":"<azure_endpoint>"},{"name":"llm_total_cost","description":"","sensitive":false,"provided":false,"value":"${llm_total_cost}"}],"inheritedParameterContexts":[],"componentType":"PARAMETER_CONTEXT"}},"flowEncodingVersion":"1.0","parameterProviders":{},"latest":false}